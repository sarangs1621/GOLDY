[
  {
    "test": "Authentication",
    "success": true,
    "details": "Successfully authenticated as testadmin",
    "timestamp": "2026-01-28T12:37:23.343793",
    "response_data": null
  },
  {
    "test": "Get Returnable Invoices",
    "success": true,
    "details": "Retrieved 9 returnable invoices",
    "timestamp": "2026-01-28T12:37:24.372036",
    "response_data": {
      "count": 9,
      "sample": [
        {
          "id": "773691ae-a0a6-4241-893f-ac14960bcdf6",
          "invoice_no": "INV-2026-0012",
          "date": "2026-01-28T12:36:16.980000",
          "party_name": "Unknown",
          "total_amount": 902.21,
          "balance_amount": 902.21,
          "items": [
            {
              "id": "c9148624-8c9e-41a2-be49-74482ebcdf93",
              "category": "Rings",
              "description": "Gold Ring 18K - Stock Test",
              "qty": 1,
              "gross_weight": 4.5,
              "stone_weight": 0.05,
              "net_gold_weight": 4.45,
              "weight": 4.45,
              "purity": 750,
              "metal_rate": 165.0,
              "gold_value": 734.25,
              "making_charge_type": "flat",
              "making_value": 100.0,
              "stone_charges": 15.0,
              "wastage_charges": 10.0,
              "item_discount": 0.0,
              "vat_percent": 5.0,
              "vat_amount": 42.96,
              "line_total": 902.21
            }
          ]
        },
        {
          "id": "e9fb66f5-5583-4b23-9798-4910be21f637",
          "invoice_no": "INV-2026-0011",
          "date": "2026-01-28T12:36:07.302000",
          "party_name": "Unknown",
          "total_amount": 1207.85,
          "balance_amount": 1207.85,
          "items": [
            {
              "id": "8b0d06ed-4823-4a69-8470-b3a4bd841dcc",
              "category": null,
              "description": "Gold Ring 22K",
              "qty": 1,
              "gross_weight": 5.25,
              "stone_weight": 0.1,
              "net_gold_weight": 5.15,
              "weight": 5.15,
              "purity": 916,
              "metal_rate": 185.5,
              "gold_value": 955.33,
              "making_charge_type": "per_gram",
              "making_value": 150.0,
              "stone_charges": 25.0,
              "wastage_charges": 20.0,
              "item_discount": 0.0,
              "vat_percent": 5.0,
              "vat_amount": 57.52,
              "line_total": 1207.85
            }
          ]
        }
      ]
    }
  },
  {
    "test": "Get Test Customer",
    "success": true,
    "details": "Using existing customer: Perf Test Party 1 20260125073346",
    "timestamp": "2026-01-28T12:37:25.046353",
    "response_data": null
  },
  {
    "test": "Create Test Invoice for Returns",
    "success": true,
    "details": "Created and finalized test invoice: INV-2026-0013",
    "timestamp": "2026-01-28T12:37:27.084237",
    "response_data": {
      "invoice_id": "e4108263-071a-4e8b-a1d3-d90a7f9d4b61",
      "invoice_number": "INV-2026-0013"
    }
  },
  {
    "test": "Get Returnable Items",
    "success": true,
    "details": "Retrieved 1 returnable items from invoice",
    "timestamp": "2026-01-28T12:37:27.866598",
    "response_data": {
      "items_count": 1,
      "sample": [
        {
          "item_id": "a2938b89-ff62-4487-85ab-4c07f34cbf1f",
          "description": "Gold Ring 22K",
          "purity": 916,
          "category": null,
          "original_qty": 1,
          "original_weight_grams": 5.15,
          "original_amount": 1207.85,
          "returned_qty": 0,
          "returned_weight_grams": 0.0,
          "remaining_qty": 1,
          "remaining_weight_grams": 5.15,
          "remaining_amount": 1207.85
        }
      ]
    }
  },
  {
    "test": "Create Draft Return",
    "success": true,
    "details": "Created draft return: RET-00003 (Amount: 603.92 OMR)",
    "timestamp": "2026-01-28T12:37:30.360998",
    "response_data": {
      "return_id": "1dabd4b2-ac3a-4ced-8312-86999bb94729",
      "return_number": "RET-00003"
    }
  },
  {
    "test": "Get Test Account",
    "success": true,
    "details": "Using existing account: Test Cash Account 1769567374",
    "timestamp": "2026-01-28T12:37:31.039681",
    "response_data": null
  },
  {
    "test": "Edit Draft Return",
    "success": true,
    "details": "Added refund details: money refund of 603.93 OMR",
    "timestamp": "2026-01-28T12:37:32.386373",
    "response_data": {
      "refund_mode": "money",
      "refund_amount": 603.93
    }
  },
  {
    "test": "Get Finalize Impact",
    "success": false,
    "details": "Failed: 520 - Internal Server Error",
    "timestamp": "2026-01-28T12:37:32.851064",
    "response_data": null
  },
  {
    "test": "Finalize Return",
    "success": false,
    "details": "Failed: 520 - {\"detail\":\"Error finalizing return: 4 validation errors for StockMovement\\nmovement_type\\n  Field required [type=missing, input_value={'id': '44acdab7-95ed-4a4...44ff-86a3-c953c630585a'}, input_type=dict]\\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\\nheader_name\\n  Field required [type=missing, input_value={'id': '44acdab7-95ed-4a4...44ff-86a3-c953c630585a'}, input_type=dict]\\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\\nqty_delta\\n  Field required [type=missing, input_value={'id': '44acdab7-95ed-4a4...44ff-86a3-c953c630585a'}, input_type=dict]\\n    For further information visit https://errors.pydantic.dev/2.12/v/missing\\nweight_delta\\n  Field required [type=missing, input_value={'id': '44acdab7-95ed-4a4...44ff-86a3-c953c630585a'}, input_type=dict]\\n    For further information visit https://errors.pydantic.dev/2.12/v/missing. Changes have been rolled back.\"}",
    "timestamp": "2026-01-28T12:37:33.888769",
    "response_data": null
  },
  {
    "test": "Validation - Exceed Original Amount",
    "success": true,
    "details": "Correctly blocked excessive return: Cannot return more quantity than original Invoice INV-2026-0013. Original qty: 1, Already returned: 0, Current return: 10, Total would be: 10",
    "timestamp": "2026-01-28T12:37:34.785971",
    "response_data": null
  },
  {
    "test": "Validation - Edit Finalized Return",
    "success": false,
    "details": "Should have blocked editing finalized return but got: 200",
    "timestamp": "2026-01-28T12:37:35.799281",
    "response_data": null
  },
  {
    "test": "Validation - Delete Finalized Return",
    "success": false,
    "details": "Should have blocked deleting finalized return but got: 200",
    "timestamp": "2026-01-28T12:37:36.691274",
    "response_data": null
  },
  {
    "test": "Get Test Vendor",
    "success": true,
    "details": "Using existing vendor: Axe",
    "timestamp": "2026-01-28T12:37:37.358846",
    "response_data": null
  },
  {
    "test": "Create Draft Purchase",
    "success": true,
    "details": "Created draft purchase (Status: Draft, Balance: 18642.75 OMR)",
    "timestamp": "2026-01-28T12:37:38.956099",
    "response_data": {
      "purchase_id": "72beec10-6d5e-4e66-b489-4752428a57f5",
      "status": "Draft",
      "balance_due": 18642.75
    }
  },
  {
    "test": "Get Test Account",
    "success": true,
    "details": "Using existing account: Test Cash Account 1769567374",
    "timestamp": "2026-01-28T12:37:39.606199",
    "response_data": null
  },
  {
    "test": "Add Payment to Purchase",
    "success": true,
    "details": "Payment added successfully (Status: None, Paid: None OMR, Balance: None OMR, Locked: False)",
    "timestamp": "2026-01-28T12:37:41.076360",
    "response_data": {
      "status": null,
      "paid_amount": null,
      "balance_due": null,
      "locked": false
    }
  },
  {
    "test": "Get Test Customer",
    "success": true,
    "details": "Using existing customer: Perf Test Party 1 20260125073346",
    "timestamp": "2026-01-28T12:37:41.748667",
    "response_data": null
  },
  {
    "test": "Invoice Stock Movements",
    "success": true,
    "details": "Stock OUT movement created: Invoice INV-2026-0014 - Finalized (Qty: -1.0, Weight: -4.45g)",
    "timestamp": "2026-01-28T12:37:44.542479",
    "response_data": {
      "movement_type": "Stock OUT",
      "qty_delta": -1.0,
      "weight_delta": -4.45
    }
  },
  {
    "test": "Finance Dashboard",
    "success": true,
    "details": "Dashboard structure valid (Categories: 13, Outstanding: 22445.55 OMR, Customers: 127)",
    "timestamp": "2026-01-28T12:37:46.118970",
    "response_data": {
      "inventory": {
        "total_categories": 13,
        "total_stock_weight_grams": 3086.0,
        "total_stock_qty": 111.0,
        "low_stock_items": 9
      },
      "financial": {
        "total_outstanding_omr": 22445.55,
        "outstanding_invoices_count": 12
      },
      "parties": {
        "total_customers": 127,
        "total_vendors": 23,
        "total": 150
      },
      "job_cards": {
        "total": 6,
        "pending": 0,
        "completed": 0
      },
      "recent_activity": {
        "recent_invoices": [
          {
            "id": "b0444704-b64c-43ec-969d-876e07cc5cbb",
            "invoice_number": "INV-2026-0014",
            "date": "2026-01-28T12:37:42.085000",
            "created_at": "2026-01-28T12:37:42.085000",
            "due_date": null,
            "customer_type": "saved",
            "customer_id": "a8b552ab-efa7-4f5b-a1ae-95064962d367",
            "customer_name": null,
            "customer_phone": null,
            "customer_address": null,
            "customer_gstin": null,
            "walk_in_name": null,
            "walk_in_phone": null,
            "worker_id": null,
            "worker_name": null,
            "invoice_type": "sale",
            "payment_status": "unpaid",
            "status": "finalized",
            "finalized_at": "2026-01-28T12:37:42.979000",
            "finalized_by": "336cdc1b-081b-44ff-86a3-c953c630585a",
            "paid_at": null,
            "items": [
              {
                "id": "a6d8e31f-4126-4149-a773-a6645a7821e2",
                "category": "Rings",
                "description": "Gold Ring 18K - Stock Test",
                "qty": 1,
                "gross_weight": 4.5,
                "stone_weight": 0.05,
                "net_gold_weight": 4.45,
                "weight": 4.45,
                "purity": 750,
                "metal_rate": 165.0,
                "gold_value": 734.25,
                "making_charge_type": "flat",
                "making_value": 100.0,
                "stone_charges": 15.0,
                "wastage_charges": 10.0,
                "item_discount": 0.0,
                "vat_percent": 5.0,
                "vat_amount": 42.96,
                "line_total": 902.21
              }
            ],
            "subtotal": 859.25,
            "discount_amount": 0.0,
            "tax_type": "cgst_sgst",
            "gst_percent": 5.0,
            "cgst_total": 21.48,
            "sgst_total": 21.48,
            "igst_total": 0.0,
            "vat_total": 42.96,
            "grand_total": 902.21,
            "paid_amount": 0.0,
            "balance_due": 902.21,
            "notes": "Test invoice for stock movement verification",
            "jobcard_id": null,
            "created_by": "336cdc1b-081b-44ff-86a3-c953c630585a",
            "is_deleted": false
          },
          {
            "id": "e4108263-071a-4e8b-a1d3-d90a7f9d4b61",
            "invoice_number": "INV-2026-0013",
            "date": "2026-01-28T12:37:25.488000",
            "created_at": "2026-01-28T12:37:25.488000",
            "due_date": null,
            "customer_type": "saved",
            "customer_id": "a8b552ab-efa7-4f5b-a1ae-95064962d367",
            "customer_name": null,
            "customer_phone": null,
            "customer_address": null,
            "customer_gstin": null,
            "walk_in_name": null,
            "walk_in_phone": null,
            "worker_id": null,
            "worker_name": null,
            "invoice_type": "sale",
            "payment_status": "unpaid",
            "status": "finalized",
            "finalized_at": "2026-01-28T12:37:26.392000",
            "finalized_by": "336cdc1b-081b-44ff-86a3-c953c630585a",
            "paid_at": null,
            "items": [
              {
                "id": "a2938b89-ff62-4487-85ab-4c07f34cbf1f",
                "category": null,
                "description": "Gold Ring 22K",
                "qty": 1,
                "gross_weight": 5.25,
                "stone_weight": 0.1,
                "net_gold_weight": 5.15,
                "weight": 5.15,
                "purity": 916,
                "metal_rate": 185.5,
                "gold_value": 955.33,
                "making_charge_type": "per_gram",
                "making_value": 150.0,
                "stone_charges": 25.0,
                "wastage_charges": 20.0,
                "item_discount": 0.0,
                "vat_percent": 5.0,
                "vat_amount": 57.52,
                "line_total": 1207.85
              }
            ],
            "subtotal": 1150.33,
            "discount_amount": 0.0,
            "tax_type": "cgst_sgst",
            "gst_percent": 5.0,
            "cgst_total": 28.76,
            "sgst_total": 28.76,
            "igst_total": 0.0,
            "vat_total": 57.52,
            "grand_total": 1207.85,
            "paid_amount": 0.0,
            "balance_due": 1207.85,
            "notes": "Test invoice for returns testing",
            "jobcard_id": null,
            "created_by": "336cdc1b-081b-44ff-86a3-c953c630585a",
            "is_deleted": false
          },
          {
            "id": "773691ae-a0a6-4241-893f-ac14960bcdf6",
            "invoice_number": "INV-2026-0012",
            "date": "2026-01-28T12:36:16.980000",
            "created_at": "2026-01-28T12:36:16.980000",
            "due_date": null,
            "customer_type": "saved",
            "customer_id": "a8b552ab-efa7-4f5b-a1ae-95064962d367",
            "customer_name": null,
            "customer_phone": null,
            "customer_address": null,
            "customer_gstin": null,
            "walk_in_name": null,
            "walk_in_phone": null,
            "worker_id": null,
            "worker_name": null,
            "invoice_type": "sale",
            "payment_status": "unpaid",
            "status": "finalized",
            "finalized_at": "2026-01-28T12:36:17.759000",
            "finalized_by": "336cdc1b-081b-44ff-86a3-c953c630585a",
            "paid_at": null,
            "items": [
              {
                "id": "c9148624-8c9e-41a2-be49-74482ebcdf93",
                "category": "Rings",
                "description": "Gold Ring 18K - Stock Test",
                "qty": 1,
                "gross_weight": 4.5,
                "stone_weight": 0.05,
                "net_gold_weight": 4.45,
                "weight": 4.45,
                "purity": 750,
                "metal_rate": 165.0,
                "gold_value": 734.25,
                "making_charge_type": "flat",
                "making_value": 100.0,
                "stone_charges": 15.0,
                "wastage_charges": 10.0,
                "item_discount": 0.0,
                "vat_percent": 5.0,
                "vat_amount": 42.96,
                "line_total": 902.21
              }
            ],
            "subtotal": 859.25,
            "discount_amount": 0.0,
            "tax_type": "cgst_sgst",
            "gst_percent": 5.0,
            "cgst_total": 21.48,
            "sgst_total": 21.48,
            "igst_total": 0.0,
            "vat_total": 42.96,
            "grand_total": 902.21,
            "paid_amount": 0.0,
            "balance_due": 902.21,
            "notes": "Test invoice for stock movement verification",
            "jobcard_id": null,
            "created_by": "336cdc1b-081b-44ff-86a3-c953c630585a",
            "is_deleted": false
          },
          {
            "id": "e9fb66f5-5583-4b23-9798-4910be21f637",
            "invoice_number": "INV-2026-0011",
            "date": "2026-01-28T12:36:07.302000",
            "created_at": "2026-01-28T12:36:07.302000",
            "due_date": null,
            "customer_type": "saved",
            "customer_id": "a8b552ab-efa7-4f5b-a1ae-95064962d367",
            "customer_name": null,
            "customer_phone": null,
            "customer_address": null,
            "customer_gstin": null,
            "walk_in_name": null,
            "walk_in_phone": null,
            "worker_id": null,
            "worker_name": null,
            "invoice_type": "sale",
            "payment_status": "unpaid",
            "status": "finalized",
            "finalized_at": "2026-01-28T12:36:08.090000",
            "finalized_by": "336cdc1b-081b-44ff-86a3-c953c630585a",
            "paid_at": null,
            "items": [
              {
                "id": "8b0d06ed-4823-4a69-8470-b3a4bd841dcc",
                "category": null,
                "description": "Gold Ring 22K",
                "qty": 1,
                "gross_weight": 5.25,
                "stone_weight": 0.1,
                "net_gold_weight": 5.15,
                "weight": 5.15,
                "purity": 916,
                "metal_rate": 185.5,
                "gold_value": 955.33,
                "making_charge_type": "per_gram",
                "making_value": 150.0,
                "stone_charges": 25.0,
                "wastage_charges": 20.0,
                "item_discount": 0.0,
                "vat_percent": 5.0,
                "vat_amount": 57.52,
                "line_total": 1207.85
              }
            ],
            "subtotal": 1150.33,
            "discount_amount": 0.0,
            "tax_type": "cgst_sgst",
            "gst_percent": 5.0,
            "cgst_total": 28.76,
            "sgst_total": 28.76,
            "igst_total": 0.0,
            "vat_total": 57.52,
            "grand_total": 1207.85,
            "paid_amount": 0.0,
            "balance_due": 1207.85,
            "notes": "Test invoice for returns testing",
            "jobcard_id": null,
            "created_by": "336cdc1b-081b-44ff-86a3-c953c630585a",
            "is_deleted": false
          },
          {
            "id": "30713144-7c62-4c2c-9127-0445c6b80263",
            "invoice_number": "INV-2026-0010",
            "date": "2026-01-28T12:34:35.905000",
            "created_at": "2026-01-28T12:34:35.905000",
            "due_date": null,
            "customer_type": "saved",
            "customer_id": "a8b552ab-efa7-4f5b-a1ae-95064962d367",
            "customer_name": null,
            "customer_phone": null,
            "customer_address": null,
            "customer_gstin": null,
            "walk_in_name": null,
            "walk_in_phone": null,
            "worker_id": null,
            "worker_name": null,
            "invoice_type": "sale",
            "payment_status": "unpaid",
            "status": "finalized",
            "finalized_at": "2026-01-28T12:34:36.683000",
            "finalized_by": "336cdc1b-081b-44ff-86a3-c953c630585a",
            "paid_at": null,
            "items": [
              {
                "id": "82a3c903-6c0f-4d88-9caf-8e46089ddaac",
                "category": "Rings",
                "description": "Gold Ring 18K - Stock Test",
                "qty": 1,
                "gross_weight": 4.5,
                "stone_weight": 0.05,
                "net_gold_weight": 4.45,
                "weight": 4.45,
                "purity": 750,
                "metal_rate": 165.0,
                "gold_value": 734.25,
                "making_charge_type": "flat",
                "making_value": 100.0,
                "stone_charges": 15.0,
                "wastage_charges": 10.0,
                "item_discount": 0.0,
                "vat_percent": 5.0,
                "vat_amount": 42.96,
                "line_total": 902.21
              }
            ],
            "subtotal": 859.25,
            "discount_amount": 0.0,
            "tax_type": "cgst_sgst",
            "gst_percent": 5.0,
            "cgst_total": 21.48,
            "sgst_total": 21.48,
            "igst_total": 0.0,
            "vat_total": 42.96,
            "grand_total": 902.21,
            "paid_amount": 0.0,
            "balance_due": 902.21,
            "notes": "Test invoice for stock movement verification",
            "jobcard_id": null,
            "created_by": "336cdc1b-081b-44ff-86a3-c953c630585a",
            "is_deleted": false
          }
        ]
      },
      "timestamp": "2026-01-28T12:37:45.908511+00:00"
    }
  }
]